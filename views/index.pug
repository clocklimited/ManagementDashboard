doctype html
html
  meta(charset='utf-8')
  link(rel='stylesheet', type='text/css', href='css/lato/stylesheet.css')
  link(rel='stylesheet', type='text/css', href='css/dashboard.css')
  link(rel='stylesheet', type='text/css', href='/src/jquery-ui.css')
  link(rel='stylesheet', type='text/css', href='/src/monthPicker.min.css')
  link(rel='stylesheet' href='//netdna.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css')
  title Clock Management Dashboard
  body
    h1 Clock Management Dashboard
    #buttons.row
      span#date 
        input.js-month-picker(style='width: 0px; height: 0px;')
      button.flat-button.js-zoom-toggle Toggle Zoom
      button.flat-button(id='selectButton') Select Graphs
      a(href='/logout')
        button.flat-button Logout
      a(href='/refresh')
        button.flat-button Refresh Cache

    h2.finance
      span.fa.fa-gbp.fa-fw
      |  Finance
    #finance.row.js-toggle-finance
      .group
        h3 Revenue 
          span#revenue-status
        #revenue.graph
      .group
        h3 Profit 
          span#profit-status
        #profit.graph
      .group
        h3 Costs
        #costs.graph
      .group
        h3 Annuity 
          span#annuity-status
        #annuity.graph  
      .group
        h3 Rev Per Head 
          span#revenue-per-head-status
        #revenue-per-head.graph
      .group
        h3 Rev VS Target 
          span#revenue-vs-target-status.status
        #revenue-vs-target.graph
      .group
        h3 Profit VS Target 
          span#profit-vs-target-status.status
        #profit-vs-target.graph
      .group
        h3 RPH VS Target 
          span#rph-vs-target-status.status
        #rph-vs-target.graph
      .group
        h3 Rev VS Target
          span#revenue-vs-target-pie-status.status
        #revenue-vs-target-pie.pie
    
    h2.sales-section
      span.fa.fa-shopping-cart.fa-fw
      |  Sales
    #sales-section.row.js-toggle-sales
      .group
        h3 Closed Deals 
          span#closed-deals-status.status
        #closed-deals.graph
      .group
        h3 Pipeline 
          span#pipeline-status.status
        #pipeline.graph
       

    h2.production
      span.fa.fa-cogs.fa-fw
      |  Production
    #production.row.js-toggle-production
      .group
        h3 Tickets
        #tickets.graph

    h2.human-resources
      span.fa.fa-users.fa-fw
      |  HR
    #human-resources.half.row.js-toggle-hr
      .group
        h3  Head Count
        #head-count.graph
      .group
        h3  Sick Days
        #sick-days.graph

      #satisfaction-group
        .group
          h3  Staff Satisfaction
          #staff-satisfaction.table
            h4 Target
              span#staff-satisfaction-target
            h4 Current
              span#staff-satisfaction-value
        .group
          h3  Client Satisfaction
          #client-satisfaction.table
            h4 Target
              span#client-satisfaction-target
            h4 Current
              span#client-satisfaction-value

    .modal#selectModal
      .modal-content
        .modal-header
          span.close X
          h2 Show Selected Graphs
        .modal-body
          h3 FINANCE
          table
            tbody
              tr
                td
                  input(type='checkbox', id='revenueChk' checked)
                  label(for='revenueChk') Revenue 
                td
                  input(type='checkbox', id='profitChk' checked)
                  label(for='profitChk') Profit
                td
                  input(type='checkbox', id='costsChk' checked)
                  label(for='costsChk') Costs
                td
                  input(type='checkbox', id='annuityChk' checked)
                  label(for='annuityChk') Annuity
              tr
                td
                  input(type='checkbox', id='rhpChk' checked)
                  label(for='rhpChk') Revenue Per Head
                td
                  input(type='checkbox', id='rvtChk' checked)
                  label(for='rvtChk') Revenue VS Target
                td
                  input(type='checkbox', id='pvtChk' checked)
                  label(for='pvtChk') Profit VS Target
                td
                  input(type='checkbox', id='rphvtChk' checked)
                  label(for='rphvtChk') RPH VS Target
              tr
                td
                  input(type='checkbox', id='rvtpieChk' checked)
                  label(for='rvtpieChk') Revenue VS Target (Pie)

  script(src='https://www.gstatic.com/charts/loader.js')
  script(src='https://code.jquery.com/jquery-3.1.0.min.js')
  script(src='https://code.jquery.com/ui/1.12.0/jquery-ui.min.js')
  script(src='/src/monthPicker.min.js')
  script(src='/src/bundle.js')
  script(type='text/javascript').
    function unZoomAll (current) {
      $('.graph').each(function (i, e) {
        zoomLevel = $(this).css('zoom')
        if (this === current) {
          return
        } else if (zoomLevel !== 1) {
          $(this).animate({ zoom: '100%' }, 200)
        }
      })
    }

    $('.js-zoom-toggle').on('click', function () {
      events = $._data($('.graph')[0], "events")
      if (events && events.click) {
        $('.graph').off('click')
      } else {
        $('.graph').on('click', function (e) {
          zoomLevel = $(this).css('zoom')

          if (zoomLevel === '1.5') {
            $(this).animate({ zoom: '100%' }, 200)
          } else {
            unZoomAll()
            $(this).animate({ zoom: '150%' }, 200)
          }      
       })
      }
    })

    $('.js-month-picker').MonthPicker({
      Button: "<button id='dateToggle' class='flat-button'>Select Date</button>"
    , MonthFormat: 'MM yy'
    , OnAfterMenuClose: function() {
      window.location.href = window.location.origin + '?month=' + $('#monthPicker').val()
    }
    })

    $('.finance').on('click', function () {
      $('.js-toggle-finance').slideToggle('slow')
    })

    $('.sales-section').on('click', function () {
      $('.js-toggle-sales').slideToggle('slow')
    })

    $('.production').on('click', function () {
      $('.js-toggle-production').slideToggle('slow')
    })

    $('.human-resources').on('click', function () {
      $('.js-toggle-hr').slideToggle('slow')
    })

    // Get the modal
    var modal = document.getElementById('selectModal')

    // Get the button that opens the modal
    var btn = document.getElementById('selectButton')

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName('close')[0]

    // When the user clicks on the button, open the modal 
    btn.onclick = function() {
        modal.style.display = 'block'
    }

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
        modal.style.display = 'none'
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = 'none'
        }
    }

